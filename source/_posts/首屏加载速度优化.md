---
title: Vue.js 性能优化实践
date: 2020-07-20 13:30:32
tags: [浏览器, 网络, 性能]
---

## 1、[webpack-bundle-analyzer](https://www.npmjs.com/package/webpack-bundle-analyzer)

* 可视化的方式分析 bundle 打包情况
* 针对性优化

#### INSTALL

```shell
npm install --save-dev webpack-bundle-analyzer
```

#### USAGE

```js
// vue.config.js
const BundleAnalyzerPlugin = require('webpack-bundle-analyzer').BundleAnalyzerPlugin;
module.exports = {
  configureWebpack: {
    plugins: [
     new BundleAnalyzerPlugin()
      ...
    ]
  }
}
```

这里主要发现两个问题：

## 1.1、组件替换不完全

* Vuetify

### 解决方案

删除这个包

## 1.2、第三方包未按需引入

* ant design
* lodash

### 解决方案

使用 babel-plugin-import 将 js 和 css 按需引入 [原理]()

## 2、gZip

* 服务器发送压缩包，浏览器进行解压
* 目的是减少资源传输时间
* 客户端发送请求时 `Accept-Encoding ` 字段说明自己接受哪些压缩方法
* 服务器发送资源时 `Content-Encoding` 字段说明数据的压缩方法
* 如果服务器在接收到请求时才进行压缩，然后压缩好再发送，压缩时间就会被用户感知

### 解决方案

使用 compression-webpack-plugin 在前端项目打包时就进行压缩

* test：正则匹配需要压缩的文件
* threshold：超过阈值进行压缩
* deleteOriginalAssets：是否删除原文件

这边由于保留了原文件及压缩包，所以打包出来的 dist 文件会比之前大，但对传输来说不影响

## 3、代码分割

* 把代码分离到不同的 bundle 中，可以按需加载或并行加载这些文件
* 常用的代码分离方法有三种：
	- 入口起点：使用 [`entry`](https://webpack.docschina.org/configuration/entry-context) 配置手动地分离代码
	- 防止重复：使用 [`SplitChunksPlugin`](https://webpack.docschina.org/plugins/split-chunks-plugin) 去重和分离 chunk
	- 动态导入：通过模块的内联函数调用来分离代码
		- 在代码中自动将使用 `import()` 加载的模块分离成独立的包

## 3.1、提取公共代码

* 相同的资源被重复加载，浪费用户的流量和服务器的成本
* 每个页面需要加载的资源太大，导致网页首屏加载缓慢，影响用户体验
* 将多个页面的公共代码抽离成单独的文件

### 解决方案

splitChunks

## 3.2、Vue.js 路由懒加载

* 把不同路由对应的组件分割成不同的代码块，当路由被访问的时候才加载对应组件

* 结合 Vue 的[异步组件](https://cn.vuejs.org/v2/guide/components-dynamic-async.html#异步组件)和 Webpack 的[代码分割功能](https://doc.webpack-china.org/guides/code-splitting-async/#require-ensure-/)

## 4、预渲染

## 5、浏览器缓存

## 6、CDN

* Content Delivery Network，内容分发网络
* 使用户可就近取得所需内容，解决Internet网络拥挤的状况，提高用户访问网站的响应速度