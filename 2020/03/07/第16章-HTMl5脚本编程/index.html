<!DOCTYPE html>
<html>
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <title>life kicks in right now</title>
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.0"></head>
  <body>
    <div class="container">
      <header class="header">
  <div class="blog-title">
    <a href="/" class="logo">life kicks in right now</a>
  </div>
  <nav class="navbar">
    <ul class="menu">
      
        <li class="menu-item">
          <a href="/" class="menu-item-link">Home</a>
        </li>
      
        <li class="menu-item">
          <a href="/archives" class="menu-item-link">Archives</a>
        </li>
      
        <li class="menu-item">
          <a href="https://github.com/ziiyan" target="_blank" rel="noopener" class="menu-item-link">Github</a>
        </li>
      
    </ul>
  </nav>
</header>
      <main class="main">
        <article class="post">
  <div class="post-title">
    <h2 class="title">第十六章 HTMl5 脚本编程</h2>
  </div>
   <div class="post-meta">
    <span class="post-time">2020-03-07</span>
  </div>
  <div class="post-content">
    <h1 id="第十六章-HTML5-脚本编程"><a href="#第十六章-HTML5-脚本编程" class="headerlink" title="第十六章 HTML5 脚本编程"></a>第十六章 HTML5 脚本编程</h1><h2 id="跨文档消息传递-XDM"><a href="#跨文档消息传递-XDM" class="headerlink" title="跨文档消息传递 XDM"></a>跨文档消息传递 XDM</h2><p>来自不同域的页面间传递消息</p>
<ul>
<li><code>postMessage(消息，域)</code> 发送【消息】给【域】中的 <code>&lt;iframe&gt;</code> 元素</li>
<li>接收到 XDM 消息时，会触发 window 对象的 message 事件，异步，有延迟</li>
<li><code>onmessage</code><ul>
<li><code>data</code></li>
<li><code>origin</code></li>
<li><code>source</code></li>
</ul>
</li>
</ul>
<h2 id="原生拖放"><a href="#原生拖放" class="headerlink" title="原生拖放"></a>原生拖放</h2><h3 id="拖放事件"><a href="#拖放事件" class="headerlink" title="拖放事件"></a>拖放事件</h3><ol>
<li><code>dragstart</code> 按下鼠标触发</li>
<li><code>drag</code> 拖动期间持续触发</li>
<li><code>dragend</code> 拖动停止时触发，无论放置目标是否有效</li>
</ol>
<ul>
<li>当被拖动到一个有效的放置目标上</li>
</ul>
<ol>
<li><code>dragenter</code> 拖动到放置目标上</li>
<li><code>dragover</code> 放置目标范围内移动持续触发</li>
<li><code>dragleave</code> 拖出放置目标范围 或 <code>drop</code> 放到放置目标中</li>
</ol>
<h3 id="自定义放置目标"><a href="#自定义放置目标" class="headerlink" title="自定义放置目标"></a>自定义放置目标</h3><p>元素默认不允许放置，修改为可放置：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> droptarget = <span class="built_in">document</span>.getElementById(<span class="string">"droptarget"</span>);</span><br><span class="line"></span><br><span class="line">EventUtil.addHandler(droptarget, <span class="string">"dragover"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">  EventUtil.preventDefault(event);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">EventUtil.addHandler(droptarget, <span class="string">"dragenter"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">  EventUtil.preventDefault(event);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h3 id="dataTransfet-对象"><a href="#dataTransfet-对象" class="headerlink" title="dataTransfet 对象"></a>dataTransfet 对象</h3><p>用于从被拖动元素向放置目标传递字符串格式的数据</p>
<ul>
<li><code>getData()</code></li>
<li><code>setData()</code></li>
</ul>
<p>保存在 dataTransfer 对象中的数据只能在 drop 事件中被读取</p>
<ul>
<li><code>dropEffect</code> 被拖动元素能执行的放置行为<ul>
<li>none</li>
<li>move</li>
<li>copy</li>
<li>link</li>
</ul>
</li>
<li><code>effectAllowed</code> 允许拖动元素的哪种 dropEffect<ul>
<li>uninitialized</li>
<li>none</li>
<li>copy</li>
<li>link</li>
<li>move</li>
<li>copyLink</li>
<li>copyMove</li>
<li>linkMove</li>
<li>all</li>
</ul>
</li>
</ul>
<h3 id="可拖动"><a href="#可拖动" class="headerlink" title="可拖动"></a>可拖动</h3><p>默认情况下，图像、链接、文本可拖动</p>
<p>其它元素可以手动设置 draggable 属性为 ture</p>
<h2 id="媒体元素"><a href="#媒体元素" class="headerlink" title="媒体元素"></a>媒体元素</h2><p><code>&lt;audio&gt;</code>、<code>&lt;video&gt;</code> 必须 src 指向要加载的媒体</p>
<h3 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h3><p>表示媒体的当前状态</p>
<h3 id="事件"><a href="#事件" class="headerlink" title="事件"></a>事件</h3><p>触发事件，监听属性变化，可能是播放结果，也可能是操作结果</p>
<h2 id="历史状态管理"><a href="#历史状态管理" class="headerlink" title="历史状态管理"></a>历史状态管理</h2><p>history 对象</p>

  </div>
</article>
      </main>
    </div>
  </body>
</html>